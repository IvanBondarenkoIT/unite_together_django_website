{% extends "base.html" %}

{% load static %}

{% block content %}

<section class="page-header">
    <img class="bg-icon" loading="lazy" alt="" src="{% static 'img/bg@2x.png' %}" />

    <div class="sec-title1">
        <div class="sublitle1">Підзаголовок</div>
        <div class="content9">
            <h1 class="events6">Події</h1>
            <div class="discover-the-diverse-range-of-wrapper">
                <div class="discover-the-diverse1">
                    Відкрийте різноманітні події та активності, які ми пропонуємо для підтримки української спільноти в Грузії.
                </div>
            </div>
        </div>
    </div>
</section>

<section class="sect-events">
    <div class="sect-events-child"></div>
    <div class="aside-box-parent">
        <div class="aside-box">
            <div class="iterative-processor">
                <div class="database-connection">
                    <div class="error-handler">
                        <a class="sport1{% if request.path == '/events/' %}-active{% endif %}"
                           href="{% url 'events' %}">Усі</a>

                        {% for category in links %}
                            <a class="sport1{% if category.slug in request.path %}-active{% endif %}"
                               href="{{ category.pre_computed_url }}">{{ category.name }}</a>
                        {% endfor %}

                        <div class="variable-holder">
                            <div class="function-caller">
                                <img class="dec-line-1-icon" loading="lazy" alt="" src="{% static 'img/decline1.svg' %}" />
                            </div>

                            <label class="select-your-city">Оберіть місто</label>
                            <form id="cityForm" method="POST" action="{% url 'events' %}">
                                {% csrf_token %}
                                <select id="cities" name="selected-city">
                                    <option value="All"{% if selected_city == "All" %} selected{% endif %}>Усі</option>
                                    {% for city in cities %}
                                        <option value="{{ city.name }}" {% if city.name == selected_city %}selected{% endif %}>
                                            {{ city.name }}
                                        </option>
                                    {% endfor %}
                                </select>
                            </form>

                            <div class="function-caller1">
                                <img class="dec-line-2-icon" loading="lazy" alt="" src="{% static 'img/decline2.svg' %}" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="audio-processor">
                <div class="availability">
                    <div class="availability1">Доступність</div>
                    <form id="filterForm" action="{% url 'events' %}" method="POST">
                        {% csrf_token %}
                        <input id="activeCheckbox" class="icon-check1" type="checkbox" name="free-spots-checkbox"
                               {% if free_spots %}checked{% endif %}>
                        <label for="activeCheckbox">Вільні місця</label>
                    </form>
                </div>
            </div>
        </div>

        <div class="stroke-manager">
            <div class="items2">
                {% for object in all_objects %}
                    <div class="item-1">
                        <div class="touch-input to-front">
                            <div class="gesture-recognizer">
                                <div class="date6">
                                    <div class="date7">
                                        <div class="facial-recognition">
                                            <div class="biometric-authentication to-center">{{ object.get_start_date_day }}</div>
                                        </div>
                                        <div class="year6">{{ object.get_start_date_month }} {{ object.get_start_date_year }}</div>
                                    </div>
                                </div>
                                <div class="age7">
                                    <div class="age8">
                                        <span>Вік: </span>
                                        <span class="span">
                                            {% if object.start_age %}
                                            	{{ object.start_age }}
                                                {% if object.end_age %}
                                                	-{{ object.end_age }}
                                                {% endif %}
                                            {% endif %}
                                            </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="gyroscope">
                            <div class="magnetometer">
                                <button class="city1">
                                    <a href="{{ object.get_url }}">
                                        <img class="icon" alt="" src="{% if object.image %}{{ object.image.url }}{% else %}{% static 'img/placeholder-image1@2x.png' %}{% endif %}"/>
                                    </a>
                                    <div class="bg-enrollment"></div>
                                    <div class="facial-expression">
                                        <img class="biometric-verification-icon" alt="" src="{% static 'img/biometric-verification.svg' %}" />
                                    </div>
                                    <div class="batumi">
                                        {% if object.selected_city %}
                                            {{ object.selected_city }}
                                        {% else %}
                                            <span>Грузія</span>
                                        {% endif %}
                                    </div>
                                </button>
                                <div class="condition-splitter">
                                    <div class="header-item">
                                        <div class="decoration1"></div>
                                        <b class="crafts-for-children">{{ object.title }}</b>
                                    </div>
                                    <div class="iteration-loop">
                                        <div class="lorem-ipsum-is-simply5">{{ object.text|safe }}</div>
                                    </div>
                                </div>
                            </div>
                            {% if object.is_active %}
                                <a class="button-join5" href="{{ object.get_url }}">
                                    <div class="join-parent3">
                                        <div class="join5">РЕЄСТРАЦІЯ</div>
                                    </div>
                                </a>
                            {% else %}
                                <button class="button-join">
                                    <div class="join-parent">
                                        <div class="join">Закрито</div>
                                        <div class="vector-wrapper">
                                            <img class="vector-icon" alt="" src="{% static 'img/vector-11.svg' %}" />
                                        </div>
                                    </div>
                                </button>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <div class="data-visualizer">
        <nav class="mt-4" aria-label="Page navigation sample">
            {% if all_objects.has_other_pages %}
                <ul class="pagination">
                    {% if all_objects.has_previous %}
                        <li class="page-item"><a class="page-link" href="?page={{ all_objects.previous_page_number }}">Попередня</a></li>
                    {% else %}
                        <li class="page-item disabled"><a class="page-link" href="#">Попередня</a></li>
                    {% endif %}

                    {% for page_number in all_objects.paginator.page_range %}
                        {% if all_objects.number == page_number %}
                            <li class="page-item active"><a class="page-link" href="#">{{ page_number }}</a></li>
                        {% else %}
                            <li class="page-item"><a class="page-link" href="?page={{ page_number }}">{{ page_number }}</a></li>
                        {% endif %}
                    {% endfor %}

                    {% if all_objects.has_next %}
                        <li class="page-item"><a class="page-link" href="?page={{ all_objects.next_page_number }}">Наступна</a></li>
                    {% else %}
                        <li class="page-item disabled"><a class="page-link" href="#">Наступна</a></li>
                    {% endif %}
                </ul>
            {% endif %}
        </nav>
    </div>
</section>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="{% static 'js/script.js' %}"></script>
<script>
    document.getElementById('cities').addEventListener('change', function() {
        document.getElementById('cityForm').submit();
    });

    window.onbeforeunload = function() {
        sessionStorage.setItem('scrollPosition', window.scrollY);
    };

    window.onload = function() {
        var scrollPosition = sessionStorage.getItem('scrollPosition');
        if (scrollPosition !== null) {
            window.scrollTo(0, parseInt(scrollPosition));
        }
    };
</script>

{% endblock %}
